function e(e){return String.fromCharCode(588*e[0]+28*e[1]+e[2]+44032)}function i(e){const i=e.charCodeAt(e.length-1)-44032;return[i/588|0,i%588/28|0,i%28]}function t(e){const t=i(e)[2];return 0===t?"":"ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ"[t-1]}function o(e){return"가"<=e[0]&&e[0]<="힣"}class n{constructor(e,i,o){this.hada=e.slice(0,-1),this.batchim=t(this.hada),this.hae=i||this.recoverHae(),this.hani=o?o.slice(0,-1):this.recoverHani(),this.hamyeon="ㄹ"===this.batchim?this.hada:this.hani}_(e,i){if(e instanceof h){if(null!=i)throw Error("If the first argument is a proper Eomi, only one argument should be given.")}else e=new h(e,i);return e.after(this)}recoverHae(){let t=i(this.hada);if(!this.batchim){if(0===t[1]||4===t[1])return this.hada;if(18===t[1])return t[1]=4,this.hada.slice(0,-1)+e(t)}return this.hada+(0===t[1]||8===t[1]?"아":"어")}recoverHani(){let t=i(this.hada);if("ㄹ"===this.batchim)return t[2]=0,this.hada.slice(0,-1)+e(t);const o=this.hae.slice(-1);return-1!=="아어".indexOf(o)?this.hae.slice(0,-1)+(this.batchim&&"으"):-1!=="와워".indexOf(o)?this.hae.slice(0,-1)+"우":"ㅎ"===this.batchim?(t[2]=0,this.hada.slice(0,-1)+e(t)):this.hada}valueOf(){return this.hada+"다"}}var s;!function(e){e.DIRECT="",e.A_EO="(아/어)",e.EU="(으)"}(s||(s={}));class r{constructor(e){const i=new Error(`Cannot parse given string ${e} to EomiUnit`);"-"===e[0]&&(e=e.slice(1));const n=e.match(/^[(]?([아-앟어-엏])(?:[/]([아-앟어-엏]))?[)]?(.*)$/),r=e.match(/^[(]?([으-읗])[)]?(.*)$/),h=e.match(/^([ㄱ-ㅎ].*)$/);if(null!==n){const[,e,o,r]=n;if(o&&t(e)!==t(o))throw i;this.body=t(e)+r,this.eomiType=s.A_EO}else if(null!==r){const[,e,i]=r;this.body=t(e)+i,this.eomiType=s.EU}else null!==h?(this.body=h[1],this.eomiType=s.EU):(this.body=e,this.eomiType=s.DIRECT);if(o(this.body)){const e=(this.body.charCodeAt(0)-44032)/588|0;this.dropRieul=-1!==[2,9,11].indexOf(e)}else this.dropRieul=-1!=="ㄴㄹㅂ".indexOf(this.body[0])}after(n){let r=n.hada;return this.eomiType===s.A_EO?r=n.hae:this.eomiType===s.EU?r=this.dropRieul?n.hani:n.hamyeon:this.dropRieul&&"ㄹ"===n.batchim&&(r=n.hani),function(n,s){const r=new Error(`Cannot concatenate '${n}' and '${s}'`);if(!n||!s||o(s))return n+s;let h=[,,"ㄱㄱ","ㄱㅅ",,"ㄴㅈ","ㄴㅎ",,,"ㄹㄱ","ㄹㅁ","ㄹㅂ","ㄹㅅ","ㄹㅌ","ㄹㅍ","ㄹㅎ",,,"ㅂㅅ",,"ㅅㅅ"].indexOf(t(n)+s[0]);if(-1===h){if(t(n))throw r;if(h="ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ".indexOf(s[0])+1,0===h)throw r}let a=i(n);return a[2]=h,n.slice(0,-1)+e(a)+s.slice(1)}(r,this.body)}valueOf(){return"-"+this.eomiType+this.body}}class h{constructor(e,i){"string"==typeof e&&(e=new r(e)),"string"==typeof i&&(i=new r(i)),this.eomi=e,this.eomiAfterBatchim=i}after(e){let i=this.eomi;return null!=this.eomiAfterBatchim&&e.batchim&&("ㄹ"===e.batchim&&i.dropRieul||(i=this.eomiAfterBatchim)),i.after(e)}valueOf(){const e=this.eomiAfterBatchim;return this.eomi+(null!=e?"/"+e:"")}}class a{constructor(){this.root={}}get(e){let i=this.root;for(let t of e){if(!i.children)return[];let e=i.children.get(t);if(!e)return[];i=e}return i.values||[]}set(e,i){let t=this.root;for(let i of e){t.children||(t.children=new Map);let e=t.children.get(i);e||(e={},t.children.set(i,e)),t=e}t.values?t.values.push(i):t.values=[i]}allPrefixes(e){let i=[],t=this.root;for(let o=0;o<e.length&&t.children;o++){let n=t.children.get(e[o]);if(!n)break;n.values&&n.values.length&&i.push([n.values,e.slice(o+1)]),t=n}return i}}function l(e){if(e<"ㄱ"||"ㅎ"<e)return e;const i=["ㄸ","ㅃ","ㅉ"];if(-1!==i.indexOf(e[0]))return e;let t=e.charCodeAt(0)-"ㄱ".charCodeAt(0);return i.forEach(i=>t-=e>i?1:0),String.fromCharCode(t+4520)}function c(e){return e.split("").map(l).join("").normalize("NFD")}class d{constructor(e,i){this.yongeons=new a,e.forEach(e=>this.addYongeon(e)),this.eomis=new Map,i.forEach(e=>this.addEomi(e))}addYongeon(e){let i="ㄹ"!==e.batchim&&void 0;this.yongeons.set(c(e.hada),{yongeon:e,eomiType:"",dropRieul:i}),this.yongeons.set(c(e.hae),{yongeon:e,eomiType:"(아/어)"}),this.yongeons.set(c(e.hamyeon),{yongeon:e,eomiType:"(으)",dropRieul:i}),"ㄹ"===e.batchim&&(this.yongeons.set(c(e.hani),{yongeon:e,eomiType:"",dropRieul:!0}),this.yongeons.set(c(e.hani),{yongeon:e,eomiType:"(으)",dropRieul:!0}))}addEomi(e){this.addEomiUnit(c(e.eomi.body),{eomi:e,eomiType:e.eomi.eomiType,dropRieul:e.eomi.dropRieul}),e.eomiAfterBatchim&&this.addEomiUnit(c(e.eomiAfterBatchim.body),{eomi:e,eomiType:e.eomiAfterBatchim.eomiType,dropRieul:e.eomiAfterBatchim.dropRieul})}addEomiUnit(e,i){let t=this.eomis.get(e);t?t.push(i):this.eomis.set(e,[i])}analyze(e){let i=[];for(let[t,o]of this.yongeons.allPrefixes(c(e)))for(let{eomi:e,eomiType:n,dropRieul:s}of this.eomis.get(o)||[])for(let o of t)n===o.eomiType&&(null!=o.dropRieul&&s!==o.dropRieul||i.push([o.yongeon,e]));return i}}export{d as Analyzer,h as E,h as Eomi,n as V,n as Yongeon};
//# sourceMappingURL=eomi.modern.js.map
